generator client {
  provider = "prisma-client-js"
  output   = "../../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model categories {
  id_category String     @id @db.VarChar(50)
  name        String     @unique @db.VarChar(50)
  description String?
  products    products[]
}

model products {
  id_product       String             @id @db.VarChar(50)
  id_category      String             @db.VarChar(50)
  name             String             @db.VarChar(50)
  description      String?            @db.VarChar(50)
  image            String?            @db.VarChar(50)
  categories       categories         @relation(fields: [id_category], references: [id_category], onDelete: NoAction, onUpdate: NoAction, map: "products_id")
  stocks           stocks[]
  transaction_logs transaction_logs[]
}

model session {
  id_session String    @id @db.VarChar(50)
  id_user    String    @db.VarChar(50)
  token      String    @unique @db.VarChar(50)
  device_id  String?   @db.VarChar(50)
  date       DateTime  @db.Date
  role       user_role @default(user)
  users      users     @relation(fields: [id_user], references: [id_user], onDelete: NoAction, onUpdate: NoAction, map: "fk_session_user")
}

model stocks {
  id_stock   String   @id @db.VarChar(50)
  id_product String   @db.VarChar(50)
  amount     Int
  price      Int
  products   products @relation(fields: [id_product], references: [id_product], onDelete: NoAction, onUpdate: NoAction, map: "id_product")
}

model transaction_logs {
  id_transaction String           @id @db.VarChar(50)
  id_user        String           @db.VarChar(50)
  id_product     String           @db.VarChar(50)
  amount         Int
  date           DateTime         @db.Date
  price          Int
  type           transaction_type
  products       products         @relation(fields: [id_product], references: [id_product], onDelete: NoAction, onUpdate: NoAction, map: "id_product")
  users          users            @relation(fields: [id_user], references: [id_user], onDelete: NoAction, onUpdate: NoAction, map: "id_user")
}

model users {
  id_user          String             @id @db.VarChar(50)
  name             String             @db.VarChar(50)
  email            String             @unique @db.VarChar(50)
  password         String             @db.VarChar(50)
  role             user_role          @default(user)
  session          session[]
  transaction_logs transaction_logs[]
}

enum transaction_type {
  buy
  sell
}

enum user_role {
  user
  admin
}
